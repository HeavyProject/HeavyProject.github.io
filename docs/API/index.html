<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-API">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.22">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Heavy RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Heavy Atom Feed"><title data-rh="true">Introduction | Heavy</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://your-docusaurus-test-site.com/docs/API"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Introduction | Heavy"><meta data-rh="true" name="description" content="In order to use this library properly, you need to learn about the interface and containers of Heavy. The library is implemented in C++ and has bindings for other languages. In order to provide a united interface (more or less) across multiple languages, some structures are used in the library. They will be explored in subsequent sections."><meta data-rh="true" property="og:description" content="In order to use this library properly, you need to learn about the interface and containers of Heavy. The library is implemented in C++ and has bindings for other languages. In order to provide a united interface (more or less) across multiple languages, some structures are used in the library. They will be explored in subsequent sections."><link data-rh="true" rel="icon" href="/img/logo.png"><link data-rh="true" rel="canonical" href="https://your-docusaurus-test-site.com/docs/API"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/docs/API" hreflang="en"><link data-rh="true" rel="alternate" href="https://your-docusaurus-test-site.com/docs/API" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.43498f05.css">
<link rel="preload" href="/assets/js/runtime~main.d7427106.js" as="script">
<link rel="preload" href="/assets/js/main.a5a0d854.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><div class="custom_navbar_Px44 navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a style="font-size:20px" class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="My Site Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">Heavy</b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link custom_navbar navbar__link--active" style="font-size:20px" href="/docs/intro">Documentation</a><a class="navbar__item navbar__link custom_navbar" style="font-size:20px" href="/Tutorial/a">Tutorial</a><a class="navbar__item navbar__link custom_navbar" style="font-size:20px" href="/blog">News</a><a class="navbar__item navbar__link custom_navbar" style="font-size:20px" href="/docs/intro">Next</a><a href="https://github.com/heavy-project" target="_blank" rel="noopener noreferrer" style="font-size:20px" class="navbar__item navbar__link custom_navbar">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/facebook/react-native" target="_blank" rel="noopener noreferrer" style="font-size:20px" class="navbar__item navbar__link custom_navbar navbar-github-link" aria-label="GitHub repository"></a><div class="toggle_vylO colorModeToggle_x44X"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></div><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/intro">intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/API">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Classification/Cart">Classification</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Clustering/DBSCAN">Clustering</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Metric/confusion">Metric</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Preprocessing/MinMaxScaler">Preprocessing</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Reduction/LDA">Reduction</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Regression/KNNRegressor">Regression</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Introduction</span><meta itemprop="position" content="1"></li></ul></nav><div class="theme-doc-markdown markdown"><h1>Introduction</h1><p>In order to use this library properly, you need to learn about the interface and containers of <code>Heavy</code>. The library is implemented in C++ and has bindings for other languages. In order to provide a united interface (more or less) across multiple languages, some structures are used in the library. They will be explored in subsequent sections.</p><h1>Data Type</h1><p>The data types of the arrays used in this library are signed and unsigned integers and floating point numbers. More specifically, supported types are <code>I8, I16, I32, I64, U8, U16, U32, U64, F16, F32, F64</code> that live in the <code>Heavy</code> namespace in C++. Note that these data types are not directly accessible in other languages from this library. When specifiying the data types in the library, These values can be used:</p><table><thead><tr><th align="center">C++</th><th align="center">Python</th><th align="center">Description</th></tr></thead><tbody><tr><td align="center">Type::I8</td><td align="center">&#x27;i8&#x27; or &#x27;int8&#x27;</td><td align="center">8-bit signed integer</td></tr><tr><td align="center">Type::I16</td><td align="center">&#x27;i16&#x27; or &#x27;int16&#x27;</td><td align="center">16-bit signed integer</td></tr><tr><td align="center">Type::I32</td><td align="center">&#x27;i32&#x27; or &#x27;int32&#x27;</td><td align="center">32-bit signed integer</td></tr><tr><td align="center">Type::I64</td><td align="center">&#x27;i64&#x27; or &#x27;int64&#x27;</td><td align="center">64-bit signed integer</td></tr><tr><td align="center">Type::U8</td><td align="center">&#x27;u8&#x27; or &#x27;uint8&#x27;</td><td align="center">8-bit unsigned integer</td></tr><tr><td align="center">Type::U16</td><td align="center">&#x27;u16&#x27; or &#x27;uint16&#x27;</td><td align="center">16-bit unsigned integer</td></tr><tr><td align="center">Type::U32</td><td align="center">&#x27;u32&#x27; or &#x27;uint32&#x27;</td><td align="center">32-bit unsigned integer</td></tr><tr><td align="center">Type::U64</td><td align="center">&#x27;u64&#x27; or &#x27;uint64&#x27;</td><td align="center">64-bit unsigned integer</td></tr><tr><td align="center">Type::F16</td><td align="center">&#x27;f16&#x27; or &#x27;float16&#x27;</td><td align="center">half precision floating-point</td></tr><tr><td align="center">Type::F32</td><td align="center">&#x27;f32&#x27; or &#x27;float32&#x27;</td><td align="center">single precision floating-point</td></tr><tr><td align="center">Type::F64</td><td align="center">&#x27;f64&#x27; or &#x27;float64&#x27;</td><td align="center">double precision floating-point</td></tr></tbody></table><h1>Device</h1><p>The containers of the library need to able to hold memory on different devices. These devices may include CPUs and GPUs. The <code>Device</code> type comes in handy here. <code>Device</code> is made of two parts. One holds the type of the device used, and the other holds the index of the device. The index is optional and if not set, selects the first device available.</p><p><code>Device</code> is constructed as such:</p><div class="language-C++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-C++ codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// C++</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using namespace Heavy;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Device device(Kind::CPU); // No index needed here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// or</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Device device(Kind::CUDA, 0); // Index is set to zero for the first CUDA device</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-Python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Python</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import heavy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">device = heavy.device(&#x27;cpu&#x27;) # No index needed here</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># or</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">device = heavy.device(&#x27;cuda&#x27;, 0) # Index is set to zero for the first CUDA device</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h1>Tensor</h1><p><code>Tensor</code> is a container of dense memory in this library. Please note that this container holds fully-packed arrays. This container is used to pass memory buffers to be processed by the library, and it wraps containers in other languages such as Numpy arrays or PyTorch tensors. Although the wrapping of native array containers occur automatically in the bindings of the higher level languages, you need to know how to manually convert and use the <code>Tensor</code> class as it will be needed in some cases.</p><p>There are multiple ways to construct the <code>Tensor</code> class:</p><div class="language-C++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-C++ codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// C++</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using namespace Heavy;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Tensor tensor; // Uninitialized tensor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Tensor tensor(Type::F32, {10, 10}); // 10x10 matrix of single precision floating-point values</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">std::vector&lt;F32&gt; data = {1, 2, 3};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// Note that here, the shared_ptr doesn&#x27;t own the memory buffer and if the vector goes out of scope, using tensor will result in undefined behavior.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Tensor tensor(std::shared_ptr&lt;F32&gt;(data.data, {}), Type::F32, {3}) // Wrapping a  C++ vector</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Tensor tensor(Device(Kind::CUDA), Type::F32, {10, 10}) // 10x10 matrix that uses the GPU memory</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-Python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Python</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import heavy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import numpy as np</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tensor = heavy.create_tensor(heavy.device(&#x27;cpu&#x27;), &#x27;f32&#x27;, [10, 10]) # 10x10 matrix of single precision floating-point values</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nparray = np.zeros((10, 10))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># You could use wrap_array function as it wraps the array and doesn&#x27;t copy it. But using wrap_array is highly dangerous because if the original numpy array is destroyed, this leads to undefined behavior.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tensor = heavy.to_heavy(nparray) # Copies the Numpy array and creates a Tensor object.</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The properties of the <code>Tensor</code> class can be used according to the table below:</p><table><thead><tr><th align="center">C++</th><th align="center">Python</th><th align="center">Description</th></tr></thead><tbody><tr><td align="center">operator bool()</td><td align="center"><strong>bool</strong></td><td align="center">Check whether the container is valid (not empty)</td></tr><tr><td align="center">dims()</td><td align="center">dims</td><td align="center">Get the number of dimensions</td></tr><tr><td align="center">numel()</td><td align="center">numel</td><td align="center">Get the number of elements in the container</td></tr><tr><td align="center">bytes()</td><td align="center">bytes</td><td align="center">Get the size of data buffer in bytes</td></tr><tr><td align="center">shape()</td><td align="center">shape</td><td align="center">Get the shape of the container</td></tr><tr><td align="center">shape(index)</td><td align="center"></td><td align="center">Get the shape element in index</td></tr><tr><td align="center">type()</td><td align="center">dtype</td><td align="center">Get the data type of the container</td></tr><tr><td align="center">device()</td><td align="center">device</td><td align="center">Get the device of the container</td></tr><tr><td align="center">copy()</td><td align="center">copy()</td><td align="center">Get a deep copy of the container</td></tr><tr><td align="center">to(type)</td><td align="center">to(type)</td><td align="center">Return a copy of the container with converted data type</td></tr><tr><td align="center">to(device)</td><td align="center">to(device)</td><td align="center">Return a copy of the container with converted device</td></tr><tr><td align="center">to(tensor)</td><td align="center">to(tensor)</td><td align="center">Copy the container into the other</td></tr><tr><td align="center">fill(value)</td><td align="center">fill(value)</td><td align="center">Fill the container with value</td></tr><tr><td align="center">data()</td><td align="center">data()</td><td align="center">Get the raw data pointer</td></tr><tr><td align="center">reshape(shape)</td><td align="center">reshape(shape)</td><td align="center">Reshape the container</td></tr><tr><td align="center">i8()</td><td align="center">i8()</td><td align="center">Return a copy of this container with data type converted to 8-bit signed integer</td></tr><tr><td align="center">i16()</td><td align="center">i16()</td><td align="center">Return a copy of this container with data type converted to 16-bit signed integer</td></tr><tr><td align="center">i32()</td><td align="center">i32()</td><td align="center">Return a copy of this container with data type converted to 32-bit signed integer</td></tr><tr><td align="center">i64()</td><td align="center">i64()</td><td align="center">Return a copy of this container with data type converted to 64-bit signed integer</td></tr><tr><td align="center">u8()</td><td align="center">u8()</td><td align="center">Return a copy of this container with data type converted to 8-bit unsigned integer</td></tr><tr><td align="center">u16()</td><td align="center">u16()</td><td align="center">Return a copy of this container with data type converted to 16-bit unsigned integer</td></tr><tr><td align="center">u32()</td><td align="center">u32()</td><td align="center">Return a copy of this container with data type converted to 32-bit unsigned integer</td></tr><tr><td align="center">u64()</td><td align="center">u64()</td><td align="center">Return a copy of this container with data type converted to 64-bit unsigned integer</td></tr><tr><td align="center">f16()</td><td align="center">f16()</td><td align="center">eturn a copy of this container with data type converted to half precision floating point</td></tr><tr><td align="center">f32()</td><td align="center">f32()</td><td align="center">Return a copy of this container with data type converted to single precision floating point</td></tr><tr><td align="center">f64()</td><td align="center">f64()</td><td align="center">Return a copy of this container with data type converted to double precision floating point</td></tr><tr><td align="center">cpu()</td><td align="center">cpu()</td><td align="center">Return a copy of this container with device converted to CPU</td></tr><tr><td align="center">cuda()</td><td align="center">cuda()</td><td align="center">Return a copy of this container with device converted to CUDA</td></tr></tbody></table><h1>Sparse</h1><p><code>Sparse</code> is a container of sparse memory. It currently supports CSR and COO formats. This container is used to pass sparse data to the algorithms to be processed and wraps similar containers in other languages such as Scipy sparse matrices. The conversion happens automatically in the interface of the library, but there will be cases that you need to work with this container directly. The library uses <code>Format</code> enumeration to indicate the format of the container.</p><p>There are multiple ways to construct the <code>Sparse</code> class:</p><div class="language-C++ codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-C++ codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// C++</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">using namespace Heavy;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Sparse sparse(Type::F32, Type::I64, {10, 10}, Format::CSR);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-Python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-Python codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Python</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import heavy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import scipy.sparse as sp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sparse = heavy.create_sparse(heavy.device(&#x27;cpu&#x27;), &#x27;f32&#x27;, &#x27;i64&#x27;, [10, 10])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The properties of the <code>Sparse</code> class can be used according to the table below:</p><table><thead><tr><th align="center">C++</th><th align="center">Python</th><th align="center">Description</th></tr></thead><tbody><tr><td align="center">operator bool()</td><td align="center"><strong>bool</strong></td><td align="center">Check whether the container is valid (not empty)</td></tr><tr><td align="center">dims()</td><td align="center">dims</td><td align="center">Get the number of dimensions (always 2)</td></tr><tr><td align="center">numel()</td><td align="center">numel</td><td align="center">Get the number of non-zero elements in container</td></tr><tr><td align="center">bytes()</td><td align="center">bytes</td><td align="center">Get the collective size of data buffers in bytes</td></tr><tr><td align="center">sparsity()</td><td align="center">sparsity</td><td align="center">Get the ratio of sparsity (from zero to one)</td></tr><tr><td align="center">shape()</td><td align="center">shape</td><td align="center">Get the shape of the container</td></tr><tr><td align="center">shape(index)</td><td align="center"></td><td align="center">Get the shape element in index</td></tr><tr><td align="center">dtype()</td><td align="center">dtype</td><td align="center">Get the data type of the container</td></tr><tr><td align="center">itype()</td><td align="center">itype</td><td align="center">Get the index type of the container</td></tr><tr><td align="center">format()</td><td align="center">format</td><td align="center">Get the format of the container (CSR, COO, ...)</td></tr><tr><td align="center">device()</td><td align="center">device</td><td align="center">Get the device of the container</td></tr><tr><td align="center">copy()</td><td align="center">copy()</td><td align="center">Get a deep copy of the container</td></tr><tr><td align="center">to(dtype, itype)</td><td align="center">to(dtype, itype)</td><td align="center">Return a copy of the container with converted data and index type</td></tr><tr><td align="center">to(format)</td><td align="center">to(format)</td><td align="center">Return a copy of the container with converted format</td></tr><tr><td align="center">to(device)</td><td align="center">to(device)</td><td align="center">Return a copy of the tensor with converted device</td></tr><tr><td align="center">value()</td><td align="center">value</td><td align="center">Get a tensor holding a reference to the value array of the container</td></tr><tr><td align="center">row()</td><td align="center">row</td><td align="center">Get a tensor holding a reference to the row array of the container</td></tr><tr><td align="center">col()</td><td align="center">col</td><td align="center">Get a tensor holding a reference to the column array of the container</td></tr><tr><td align="center">data()</td><td align="center">data()</td><td align="center">Get the raw data pointer</td></tr><tr><td align="center">csr()</td><td align="center">csr()</td><td align="center">Return a copy of this container with device converted to the CSR format</td></tr><tr><td align="center">coo()</td><td align="center">coo()</td><td align="center">Return a copy of this container with device converted to the COO format</td></tr><tr><td align="center">cpu()</td><td align="center">cpu()</td><td align="center">Return a copy of this container with device converted to CPU</td></tr><tr><td align="center">cuda()</td><td align="center">cuda()</td><td align="center">Return a copy of this container with device converted to CUDA</td></tr></tbody></table></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/intro"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">intro</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Classification/Cart"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Cart</div></a></nav></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/intro">Tutorial</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><img src="/img/logo.png" alt="Meta Open Source Logo" class="themedImage_ToTc themedImage--light_HNdA footer__logo" width="70" height="80"><img src="/img/logo.png" alt="Meta Open Source Logo" class="themedImage_ToTc themedImage--dark_i4oU footer__logo" width="70" height="80"></div><div class="footer__copyright">Copyright © 2022 Heavy Project. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.d7427106.js"></script>
<script src="/assets/js/main.a5a0d854.js"></script>
</body>
</html>